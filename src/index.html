<!DOCTYPE html>
<html>
    
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta charset="utf-8">

        <!-- Meta for search -->
        <meta name="keywords" content="серф, серфинг, серф-спот, спот" />
        <meta name="description" content="Серф-споты, школы, шейперы, аксессуары" />
        <meta name="author" content="Alexander Niki" />
        <meta http-equiv="content-language" content="ru" />

        <!-- Styles -->
        <link id="theme" rel="stylesheet" type="text/css" href="app/theme-light.css">
        <link rel="stylesheet" type="text/css" href="app/style.css">
        
        <!-- Favicon -->
        <link rel="icon" type="image/png" href="media/favicon.png">

        <!-- Reference the manifest file; is must for PWA. -->
        <link rel="manifest" href="manifest.json" />

        <!-- Scripts -->
        <!--<script src="https://telegram.org/js/telegram-web-app.js"></script>-->
        <script src="app/data.js"></script>
        <script src="app/app.js"></script>

        <!-- Init -->
        <script>
            const instanceState = {
                // Basic page parameters
                spotcode: "ruspb",
                //placecode: "ruspb",
            };
            main();
            const app = new SurflApp();
            const page = new IndexPage();
        </script>
        <!-- Google Analytics -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-23XXL476QR"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-23XXL476QR');
        </script>

        <title>Серфинг в Санкт-Петербурге</title>
    </head>

    <body>

        <header>
            <div class="uix-toolbar-main uix-toolbar--topnav" id="toolbar-topnav">
                <!-- MenuButton -->
                <a href="javascript:void(0);" onclick="toggleNavigation()" id="toolbar-topnav-menubutton">
                    <div class="ic-menu">
                        <div class="ic-menu-hline"></div>
                        <!--<div class="ic-menu-hline"></div>-->
                        <div class="ic-menu-hline"></div>
                    </div>
                </a>
                <!-- /MenuButton -->
                <div id="install">Install App</div>
            </div>
            <!-- MainMenu -->
            <div class="uix-layout--vbox" id="toolbar-topnav-menu">
                <div><a href="javascript:void(0);" onclick="toggleNavigation()">✕</a></div>
                <div class="uix-layout--vbox">
                    <!-- Logo -->
                    <div class="logo-container">
                        <img src="media/main-logo.png" style="height:100%; width:auto" />
                    </div>
                    <!-- /Logo -->
                    <div class="main-nav-divider"></div>
                    <!-- CitySelector -->
                    <div>
                        <label class="body" for="list-cities">Россия,</label>
                        <select class="body uix-dropdown" id="list-cities" name="list-cities">
                            <option class="uix-dropdown--option" value="spb">Санкт-Петербург</option>
                            <option class="uix-dropdown--option" value="konig">Калининград</option>
                        </select>
                        <script>page.cityList();</script>
                    </div>
                    <!-- /CitySelector -->
                    <div class="main-nav-divider"></div>
                    <!-- Links -->
                    <div class="uix-layout--grid--wrapped id="">    
                        <nav class="" id="">
                            <ul class="uix-layout--vbox--compact uix-tabbar--navlinks" id="">
                                <li class="uix-tabview--tablink active" onclick="page.openTab(event, 'main-spots')">Споты</li>
                                <!--<li class="" onclick="openTab(event, 'main-equp')">Экипировка</li>-->
                                <li class="uix-tabview--tablink" onclick="page.openTab(event, 'main-communication')">Общение</li>
                                <li class="uix-tabview--tablink" onclick="page.openTab(event, 'main-rent')">Прокаты, школы, инструкторы</li>
                                <li class="uix-tabview--tablink" onclick="page.openTab(event, 'main-stores')">Магазины</li>
                                <li class="uix-tabview--tablink" onclick="page.openTab(event, 'main-workshops')">Шейперы, мастерские</li>
                            </ul>
                        </nav>
                    </div>
                    <!-- /Links -->
                </div>
            </div>
            <!-- /MainMenu -->
        </header>

        <main id="app-content">
            <!-- NOTIFICATIONS -->
            <div id="inline-notification">
                <script>app.showInlineNotification("inline-notification");</script>
            </div>
            <!-- / NOTIFICATIONS -->
            
            <section class="uix-layout--vbox uix-tabview--tabcontent uix-tabview--tabcontent--default" id="main-spots">
                <span class="headline-6 typography-bold">Споты</span>

                <!-- SPOT FORECAST -->
                <div class="uix-card--spot--forecast">
                    <div class="uix-layout--vbox-compact">
                        <span class="caption-accent">Могут работать</span>
                        <div class="uix-layout--vbox-compact" id="spot-forecast">
                            <div class="loader" id="forecast-loader"></div>
                        </div>
                    </div>
                </div>
                <script>page.cityForecast();</script>
                <!-- / SPOT FORECAST -->

                <span class="title">Популярные</span>
                <div class="uix-layout--grid--wrapped" id="spots-popular">
                    <script>page.popularSpots();</script>
                </div>

                <div class="uix-layout--vbox" id="collection-spots">
                    <script>page.spots();</script>
                </div>
            </section>

            <section class="uix-tabview--tabcontent uix-layout--vbox" id="main-rent">
                <span class="headline-6 typography-bold">Прокаты, школы, инструкторы</span>
                <div class="uix-layout--grid--wrapped" id="collection-orgs"></div>
                <script>page.orgs();</script>
            </section>
            
            <section class="uix-tabview--tabcontent uix-layout--vbox" id="main-other">
                <span class="headline-6 typography-bold">Другое</span>
                <div class="uix-layout--grid--wrapped">
                    <div class="uix-card--other--minimal uix-state--disabled" id="card-equip">
                        <span class="caption-accent">Экипировка</span>
                        <span class="body-1">
                            <ul>
                                <li>Вещи</li>
                                <li>Советы</li>
                            </ul>
                        </span>
                        <span class="headline-5 typography-bold" id="uix-card-minimal--align-right">→</span>
                    </div>
                    <a href="communication.html"><div class="uix-card--other--minimal uix-card--link--overall" id="card-communication" onclick="location.href='communication.html'">
                        <div class="uix-layout--vbox-compact">
                            <span class="caption-accent">Общение</span>
                            <span class="uix-card--secondary-text">
                                <ul>
                                    <li>Telegram</li>
                                    <li>WhatsApp</li>
                                    <li>и другие способы общаться</li>
                                </ul>
                            </span>
                        </div>
                        <span class="headline-5 uix-card--secondary-text" id="uix-card-minimal--align-right">→</span>
                    </div></a>
                </div>
            </section>

            <section class="uix-tabview--tabcontent uix-layout--vbox" id="main-stores">
                <span class="headline-6 typography-bold">Магазины</span>
                <div class="uix-layout--grid--wrapped" id="collection-stores"></div>
                <script>page.stores();</script>
            </section>


            <section class="uix-tabview--tabcontent uix-layout--vbox" id="main-workshops">
                <span class="headline-6 typography-bold">Шейперы и мастерские</span>
                <div class="uix-layout--grid--wrapped" id="collection-workshops"></div>
                <script>page.workshops();</script>
            </section>

            <section class="uix-tabview--tabcontent uix-layout--vbox" id="main-communication">
                <span class="headline-6 typography-bold">Общение</span>
                <!-- Communication cards -->
                <div class="uix-layout--grid--wrapped" id="collection-communication"></div>
                <script>page.сommunications();</script>
                <!-- / Communication cards -->
            </section>
        
        </main>

        <footer>
            <component-footer></component-footer>
        </footer>

        <!-- Reference the PWA scripts. -->
        <script>
            if('serviceWorker' in navigator) {
        
                /**
                 * Define if <link rel='next|prev|prefetch'> should
                 * be preloaded when accessing this page
                 */
                const PREFETCH = true;
        
                /**
                 * Define which link-rel's should be preloaded if enabled.
                 */
                const PREFETCH_LINK_RELS = ['index','next', 'prev', 'prefetch'];
        
                /**
                 * prefetchCache
                 */
                function prefetchCache() {
                    if(navigator.serviceWorker.controller) {
        
                        let links = document.querySelectorAll(
                            PREFETCH_LINK_RELS.map((rel) => {
                                return 'link[rel='+rel+']';
                            }).join(',')
                        );
        
                        if(links.length > 0) {
                            Array.from(links)
                                .map((link) => {
                                    let href = link.getAttribute('href');
                                    navigator.serviceWorker.controller.postMessage({
                                        action : 'cache',
                                        url : href,
                                    });
                                });
                        }
        
        
                    }
                }
        
                /**
                 * Register Service Worker
                 */
                navigator.serviceWorker
                    .register('sw.js', { scope: '/' })
                    .then(() => {
                        console.log('Service Worker Registered');
                    });
        
                /**
                 * Wait if ServiceWorker is ready
                 */
                navigator.serviceWorker
                    .ready
                    .then(() => {
                        if(PREFETCH) {
                            prefetchCache();
                        }
                    });
        
            }
        </script>
        
    </body>

</html>